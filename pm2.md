# ğŸ“‹ PM2 ê´€ë¦¬ ê°€ì´ë“œ

## ğŸš€ ë¹ ë¥¸ ì‹œì‘

### 1. í”„ë¡œë•ì…˜ ë°°í¬

```bash
# ë¹Œë“œ í›„ PM2ë¡œ ì‹œì‘
npm run deploy
```

### 2. ìƒíƒœ í™•ì¸

```bash
# ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
npm run pm2:status
```

### 3. ë¡œê·¸ í™•ì¸

```bash
# ì‹¤ì‹œê°„ ë¡œê·¸ ë³´ê¸°
npm run pm2:logs
```

## ğŸ”§ ìƒì„¸ ëª…ë ¹ì–´

### ì„œë²„ ì œì–´

| ëª…ë ¹ì–´                  | ì„¤ëª…                        | ì‚¬ìš© ì‹œê¸°         |
| ----------------------- | --------------------------- | ----------------- |
| `npm run pm2:start`     | í”„ë¡œë•ì…˜ ì„œë²„ ì‹œì‘          | ìµœì´ˆ ë°°í¬ ì‹œ      |
| `npm run pm2:start:dev` | ê°œë°œ í™˜ê²½ìœ¼ë¡œ ì‹œì‘          | ê°œë°œ í…ŒìŠ¤íŠ¸ ì‹œ    |
| `npm run pm2:stop`      | ì„œë²„ ì¤‘ì§€                   | ì„œë²„ ì •ì§€ í•„ìš” ì‹œ |
| `npm run pm2:restart`   | ì„œë²„ ì¬ì‹œì‘ (ë‹¤ìš´íƒ€ì„ ìˆìŒ) | ì„¤ì • ë³€ê²½ í›„      |
| `npm run pm2:reload`    | ë¬´ì¤‘ë‹¨ ì¬ì‹œì‘               | ì½”ë“œ ì—…ë°ì´íŠ¸ í›„  |
| `npm run pm2:delete`    | í”„ë¡œì„¸ìŠ¤ ì™„ì „ ì‚­ì œ          | ì™„ì „ ì¬ì„¤ì • ì‹œ    |

### ëª¨ë‹ˆí„°ë§

| ëª…ë ¹ì–´                   | ì„¤ëª…             | ì •ë³´                  |
| ------------------------ | ---------------- | --------------------- |
| `npm run pm2:status`     | í”„ë¡œì„¸ìŠ¤ ìƒíƒœ    | CPU, ë©”ëª¨ë¦¬, ê°€ë™ì‹œê°„ |
| `npm run pm2:monit`      | ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§  | ë¦¬ì†ŒìŠ¤ ì‚¬ìš©ëŸ‰ ì‹¤ì‹œê°„  |
| `npm run pm2:logs`       | ì „ì²´ ë¡œê·¸ ë³´ê¸°   | ì• í”Œë¦¬ì¼€ì´ì…˜ ë¡œê·¸     |
| `npm run pm2:logs:error` | ì—ëŸ¬ ë¡œê·¸ë§Œ ë³´ê¸° | ì˜¤ë¥˜ ë””ë²„ê¹…           |

### ë¡œê·¸ ê´€ë¦¬

| ëª…ë ¹ì–´              | ì„¤ëª…               | ì£¼ê¸° |
| ------------------- | ------------------ | ---- |
| `npm run pm2:flush` | ë¡œê·¸ íˆìŠ¤í† ë¦¬ ì‚­ì œ | ì£¼ê°„ |
| `npm run pm2:reset` | ë©”íŠ¸ë¦­ ì´ˆê¸°í™”      | ì›”ê°„ |

### ìë™ ì‹œì‘ ì„¤ì •

```bash
# 1. ì„œë²„ ì¬ë¶€íŒ… ì‹œ ìë™ ì‹œì‘ ì„¤ì •
npm run pm2:startup

# 2. í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ ì €ì¥
npm run pm2:save

# 3. ì„œë²„ ì¬ë¶€íŒ… í›„ ì €ì¥ëœ í”„ë¡œì„¸ìŠ¤ ë³µì›
npm run pm2:resurrect
```

## âš™ï¸ ì„¤ì • íŒŒì¼ (ecosystem.config.js)

### í˜„ì¬ ì„¤ì •

```javascript
{
  name: 'invitation',
  port: 4000,
  instances: 1,
  memory_limit: '1GB',
  auto_restart: true,
  max_restarts: 10
}
```

### ê³ ì„±ëŠ¥ ì„œë²„ìš© ì„¤ì •

```javascript
// ecosystem.config.jsì—ì„œ ìˆ˜ì •
instances: 'max',        // CPU ì½”ì–´ ìˆ˜ë§Œí¼ ì‹¤í–‰
exec_mode: 'cluster',    // í´ëŸ¬ìŠ¤í„° ëª¨ë“œ
max_memory_restart: '2G' // ë©”ëª¨ë¦¬ ì œí•œ ì¦ê°€
```

## ğŸ” íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ìì£¼ ë°œìƒí•˜ëŠ” ë¬¸ì œ

#### 1. í¬íŠ¸ ì´ë¯¸ ì‚¬ìš© ì¤‘

```bash
# í˜„ì¬ ì‹¤í–‰ ì¤‘ì¸ í”„ë¡œì„¸ìŠ¤ í™•ì¸
npm run pm2:status

# ê¸°ì¡´ í”„ë¡œì„¸ìŠ¤ ì‚­ì œ í›„ ì¬ì‹œì‘
npm run pm2:delete
npm run pm2:start
```

#### 2. ë©”ëª¨ë¦¬ ë¶€ì¡±ìœ¼ë¡œ ì¬ì‹œì‘ ë°˜ë³µ

```bash
# ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ í™•ì¸
npm run pm2:monit

# ecosystem.config.jsì—ì„œ max_memory_restart ê°’ ì¦ê°€
```

#### 3. ë¡œê·¸ íŒŒì¼ ìš©ëŸ‰ ì¦ê°€

```bash
# ë¡œê·¸ íŒŒì¼ ì‚­ì œ
npm run pm2:flush

# ë¡œê·¸ ë¡œí…Œì´ì…˜ ì„¤ì • (ecosystem.config.js)
log_file: './logs/combined.log',
log_date_format: 'YYYY-MM-DD HH:mm Z'
```

## ğŸ“Š ëª¨ë‹ˆí„°ë§ ëŒ€ì‹œë³´ë“œ

### PM2 Plus (ì„ íƒì‚¬í•­)

```bash
# PM2 Plus ê³„ì • ì—°ê²°
pm2 link <secret_key> <public_key>

# ì›¹ ëŒ€ì‹œë³´ë“œì—ì„œ ëª¨ë‹ˆí„°ë§
# https://app.pm2.io
```

### ë¡œì»¬ ëª¨ë‹ˆí„°ë§

```bash
# í„°ë¯¸ë„ì—ì„œ ì‹¤ì‹œê°„ ëª¨ë‹ˆí„°ë§
npm run pm2:monit
```

## ğŸš€ ë°°í¬ ì›Œí¬í”Œë¡œìš°

### ê°œë°œ â†’ í”„ë¡œë•ì…˜

```bash
# 1. ì½”ë“œ ë³€ê²½ í›„
git add .
git commit -m "update: ê¸°ëŠ¥ ê°œì„ "

# 2. ë¹Œë“œ í…ŒìŠ¤íŠ¸
npm run build

# 3. PM2ë¡œ ë¬´ì¤‘ë‹¨ ë°°í¬
npm run pm2:reload

# 4. ìƒíƒœ í™•ì¸
npm run pm2:status
npm run pm2:logs
```

### ì„œë²„ ì´ì „ ì‹œ

```bash
# ê¸°ì¡´ ì„œë²„ì—ì„œ
npm run pm2:save

# ìƒˆ ì„œë²„ì—ì„œ
npm install -g pm2
npm install
npm run build
npm run pm2:start
npm run pm2:startup
```
